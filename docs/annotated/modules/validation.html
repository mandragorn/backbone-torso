<!DOCTYPE html>

<html>
<head>
  <title>validation.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="Behavior.html">
                  modules/Behavior.js
                </a>
              
                
                <a class="source" href="Cell.html">
                  modules/Cell.js
                </a>
              
                
                <a class="source" href="Collection.html">
                  modules/Collection.js
                </a>
              
                
                <a class="source" href="Events.html">
                  modules/Events.js
                </a>
              
                
                <a class="source" href="FormModel.html">
                  modules/FormModel.js
                </a>
              
                
                <a class="source" href="FormView.html">
                  modules/FormView.js
                </a>
              
                
                <a class="source" href="ListView.html">
                  modules/ListView.js
                </a>
              
                
                <a class="source" href="Model.html">
                  modules/Model.js
                </a>
              
                
                <a class="source" href="NestedCell.html">
                  modules/NestedCell.js
                </a>
              
                
                <a class="source" href="NestedModel.html">
                  modules/NestedModel.js
                </a>
              
                
                <a class="source" href="Router.html">
                  modules/Router.js
                </a>
              
                
                <a class="source" href="ServiceCell.html">
                  modules/ServiceCell.js
                </a>
              
                
                <a class="source" href="View.html">
                  modules/View.js
                </a>
              
                
                <a class="source" href="behaviors/DataBehavior.html">
                  modules/behaviors/DataBehavior.js
                </a>
              
                
                <a class="source" href="configure.html">
                  modules/configure.js
                </a>
              
                
                <a class="source" href="handlebarsUtils.html">
                  modules/handlebarsUtils.js
                </a>
              
                
                <a class="source" href="history.html">
                  modules/history.js
                </a>
              
                
                <a class="source" href="mixins/cacheMixin.html">
                  modules/mixins/cacheMixin.js
                </a>
              
                
                <a class="source" href="mixins/cellMixin.html">
                  modules/mixins/cellMixin.js
                </a>
              
                
                <a class="source" href="mixins/loadingMixin.html">
                  modules/mixins/loadingMixin.js
                </a>
              
                
                <a class="source" href="mixins/modelMixin.html">
                  modules/mixins/modelMixin.js
                </a>
              
                
                <a class="source" href="mixins/pollingMixin.html">
                  modules/mixins/pollingMixin.js
                </a>
              
                
                <a class="source" href="registry.html">
                  modules/registry.js
                </a>
              
                
                <a class="source" href="stickitUtils.html">
                  modules/stickitUtils.js
                </a>
              
                
                <a class="source" href="templateRenderer.html">
                  modules/templateRenderer.js
                </a>
              
                
                <a class="source" href="torso.html">
                  modules/torso.js
                </a>
              
                
                <a class="source" href="validation.html">
                  modules/validation.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>validation.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">root, factory</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
    define([<span class="hljs-string">'underscore'</span>, <span class="hljs-string">'./NestedModel'</span>], factory);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> exports === <span class="hljs-string">'object'</span>) {
    <span class="hljs-built_in">module</span>.exports = factory(<span class="hljs-built_in">require</span>(<span class="hljs-string">'underscore'</span>), <span class="hljs-built_in">require</span>(<span class="hljs-string">'./NestedModel'</span>));
  } <span class="hljs-keyword">else</span> {
    root.Torso = root.Torso || {};
    root.Torso.Mixins = root.Torso.Mixins || {};
    root.Torso.validation = factory(root._, root.Torso.NestedModel);
    root.Torso.Mixins.validation = root.Torso.validation.mixin;
  }
}(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">_, NestedModel</span>) </span>{
<span class="hljs-meta">  'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="default-options">Default options</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> defaultOptions = {
    <span class="hljs-attr">forceUpdate</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">selector</span>: <span class="hljs-string">'name'</span>,
    <span class="hljs-attr">labelFormatter</span>: <span class="hljs-string">'sentenceCase'</span>,
    <span class="hljs-attr">messageFormatter</span>: <span class="hljs-string">'none'</span>,
    <span class="hljs-attr">valid</span>: <span class="hljs-built_in">Function</span>.prototype,
    <span class="hljs-attr">invalid</span>: <span class="hljs-built_in">Function</span>.prototype
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2 id="helper-functions">Helper functions</h2>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Formatting functions used for formatting error messages</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> formatFunctions = {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Uses the configured label formatter to format the attribute name
to make it more readable for the user</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    formatLabel: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrName, model</span>) </span>{
      <span class="hljs-keyword">return</span> defaultLabelFormatters[defaultOptions.labelFormatter](attrName, model);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Replaces nummeric placeholders like {0} in a string with arguments
passed to the function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    format: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> defaultMessageFormatters[defaultOptions.messageFormatter].apply(defaultMessageFormatters, <span class="hljs-built_in">arguments</span>);
    }
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Flattens an object
eg:</p>
<pre><code><span class="hljs-keyword">var</span> o = {
  <span class="hljs-attr">owner</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Backbone'</span>,
    <span class="hljs-attr">address</span>: {
      <span class="hljs-attr">street</span>: <span class="hljs-string">'Street'</span>,
      <span class="hljs-attr">zip</span>: <span class="hljs-number">1234</span>
    }
  }
};</code></pre><p>becomes:</p>
<pre><code><span class="hljs-keyword">var</span> o = {
  <span class="hljs-string">'owner'</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Backbone'</span>,
    <span class="hljs-attr">address</span>: {
      <span class="hljs-attr">street</span>: <span class="hljs-string">'Street'</span>,
      <span class="hljs-attr">zip</span>: <span class="hljs-number">1234</span>
    }
  },
  <span class="hljs-string">'owner.name'</span>: <span class="hljs-string">'Backbone'</span>,
  <span class="hljs-string">'owner.address'</span>: {
    <span class="hljs-attr">street</span>: <span class="hljs-string">'Street'</span>,
    <span class="hljs-attr">zip</span>: <span class="hljs-number">1234</span>
  },
  <span class="hljs-string">'owner.address.street'</span>: <span class="hljs-string">'Street'</span>,
  <span class="hljs-string">'owner.address.zip'</span>: <span class="hljs-number">1234</span>
};</code></pre><p>This may seem redundant, but it allows for maximum flexibility
in validation rules.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> flatten = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, into, prefix</span>) </span>{
    into = into || {};
    prefix = prefix || <span class="hljs-string">''</span>;

    _.each(obj, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val, key</span>) </span>{
      <span class="hljs-keyword">if</span>(obj.hasOwnProperty(key)) {
        <span class="hljs-keyword">if</span> (!!val &amp;&amp; <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'object'</span> &amp;&amp; val.constructor === <span class="hljs-built_in">Object</span>) {
          flatten(val, into, prefix + key + <span class="hljs-string">'.'</span>);
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Register the current level object as well</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        into[prefix + key] = val;
      }
    });

    <span class="hljs-keyword">return</span> into;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2 id="validation">Validation</h2>

            </div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-comment">/**
   * Validation object containing validation mixin.
   *
   * @namespace Validation
   *
   * @author ariel.wexler@vecna.com, kent.willis@mostlyepic.com
   *
   * @see &lt;a href="../annotated/modules/validation.html"&gt;validation Annotated Source&lt;/a&gt;
   */</span>
  <span class="hljs-keyword">var</span> Validation = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Returns an object with undefined properties for all
attributes on the model that has defined one or more
validation rules.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> getValidatedAttrs = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model, attrs</span>) </span>{
      attrs = attrs || _.keys(_.result(model, <span class="hljs-string">'validation'</span>) || {});
      <span class="hljs-keyword">return</span> _.reduce(attrs, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">memo, key</span>) </span>{
        memo[key] = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> memo;
      }, {});
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Returns an array with attributes passed through options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> getOptionsAttrs = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      <span class="hljs-keyword">var</span> attrs = options.attributes;
      <span class="hljs-keyword">if</span> (_.isFunction(attrs)) {
        attrs = attrs();
      }
      <span class="hljs-keyword">if</span> (_.isArray(attrs)) {
        <span class="hljs-keyword">return</span> attrs;
      }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Looks on the model for validations for a specified
attribute. Returns an array of any validators defined,
or an empty array if none is defined.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> getValidators = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model, attr</span>) </span>{
      <span class="hljs-keyword">var</span> attrValidationSet = model.validation ? _.result(model, <span class="hljs-string">'validation'</span>)[attr] || {} : {};</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>If the validator is a function or a string, wrap it in a function validator</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.isFunction(attrValidationSet) || _.isString(attrValidationSet)) {
        attrValidationSet = {
          <span class="hljs-attr">fn</span>: attrValidationSet
        };
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Stick the validator object into an array</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span>(!_.isArray(attrValidationSet)) {
        attrValidationSet = [attrValidationSet];
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Reduces the array of validators into a new array with objects
with a validation method to call, the value to validate against
and the specified error message, if any</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">return</span> _.reduce(attrValidationSet, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">memo, attrValidation</span>) </span>{
        _.each(_.without(_.keys(attrValidation), <span class="hljs-string">'msg'</span>, <span class="hljs-string">'msgKey'</span>), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">validator</span>) </span>{
          memo.push({
            <span class="hljs-attr">fn</span>: defaultValidators[validator],
            <span class="hljs-attr">val</span>: attrValidation[validator],
            <span class="hljs-attr">msg</span>: attrValidation.msg,
            <span class="hljs-attr">msgKey</span>: attrValidation.msgKey
          });
        });
        <span class="hljs-keyword">return</span> memo;
      }, []);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Gets the indices out of an attr name: foo[0][1] -&gt; [0, 1] and foo[2] -&gt; [2]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> extractIndices = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr</span>) </span>{
      <span class="hljs-keyword">var</span> startIndex, endIndex,
        i = <span class="hljs-number">0</span>,
        hasEndBracket = <span class="hljs-literal">true</span>,
        indices = [];
      startIndex = attr.indexOf(<span class="hljs-string">'['</span>, i);
      <span class="hljs-keyword">while</span> (startIndex &gt; <span class="hljs-number">0</span> &amp;&amp; hasEndBracket) {
         endIndex = attr.indexOf(<span class="hljs-string">']'</span>, i);
         indices.push(<span class="hljs-built_in">parseInt</span>(attr.substring(startIndex + <span class="hljs-number">1</span>, endIndex), <span class="hljs-number">10</span>));
         i = endIndex + <span class="hljs-number">1</span>;
         hasEndBracket = i &gt; <span class="hljs-number">0</span>;
         startIndex = attr.indexOf(<span class="hljs-string">'['</span>, i);
      }
      <span class="hljs-keyword">return</span> indices;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Generates an array of all the possible field accessors and their indices when using the “open” array notation
foo[] -&gt; [{attr: ‘foo[0]’, index: [0]}, {attr: ‘foo[1]’, index: [1]}].  Will also perform nested arrays:
foo[][] -&gt; [[{attr: ‘foo[0][0]’, index: [0][0]}], [{attr: ‘foo[1][0]’, index: [1][0]}]]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> generateSubAttributes = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr, model, subIndices</span>) </span>{
      <span class="hljs-keyword">var</span> i, attrName, remainder, subAttrs, newIndices,
        firstBracket = attr.indexOf(<span class="hljs-string">'[]'</span>);
      <span class="hljs-keyword">if</span> (_.isEmpty(subIndices)) {
        subIndices = [];
      }
      <span class="hljs-keyword">if</span> (firstBracket === <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> {<span class="hljs-attr">attr</span>: attr, <span class="hljs-attr">index</span>: subIndices};
      } <span class="hljs-keyword">else</span> {
        attrName = attr.substring(<span class="hljs-number">0</span>, firstBracket);
        remainder = attr.substring(firstBracket + <span class="hljs-number">2</span>);
        subAttrs = [];
        <span class="hljs-keyword">var</span> valueArray = model.get(attrName);
        _.each(valueArray, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, i</span>) </span>{
          newIndices = subIndices.slice();
          newIndices.push(i);
          subAttrs.push(generateSubAttributes(attrName + <span class="hljs-string">'['</span> + i + <span class="hljs-string">']'</span> + remainder, model, newIndices));
        });
        <span class="hljs-keyword">return</span> subAttrs;
      }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Is this model a nested torso model</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> isNestedModel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model</span>) </span>{
      <span class="hljs-keyword">return</span> NestedModel &amp;&amp; model <span class="hljs-keyword">instanceof</span> NestedModel;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Is the attribute using dot notation or array notation: foo.bar or foo[] or foo[1]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> isNestedAttr = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr</span>) </span>{
      <span class="hljs-keyword">return</span> attr.indexOf(<span class="hljs-string">'.'</span>) &gt; <span class="hljs-number">0</span> || attr.indexOf(<span class="hljs-string">']'</span>) &gt; <span class="hljs-number">0</span>;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Remove the indices for a field name: foo[1][2] -&gt; foo[][]</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> stripIndices = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr</span>) </span>{
      <span class="hljs-keyword">var</span> startIndex, newAttr,
        i = <span class="hljs-number">0</span>,
        hasEndBracket = <span class="hljs-literal">true</span>;
      startIndex = attr.indexOf(<span class="hljs-string">'['</span>, i);
      <span class="hljs-keyword">if</span> (startIndex &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> attr;
      }
      newAttr = attr.substring(<span class="hljs-number">0</span>, startIndex + <span class="hljs-number">1</span>);
      <span class="hljs-keyword">while</span> (startIndex &gt; <span class="hljs-number">0</span> &amp;&amp; hasEndBracket) {
         i = attr.indexOf(<span class="hljs-string">']'</span>, i) + <span class="hljs-number">1</span>;
         hasEndBracket = i &gt; <span class="hljs-number">0</span>;
         startIndex = attr.indexOf(<span class="hljs-string">'['</span>, i);
         <span class="hljs-keyword">if</span> (startIndex &gt; <span class="hljs-number">0</span>) {
           newAttr = newAttr + attr.substring(i - <span class="hljs-number">1</span>, startIndex + <span class="hljs-number">1</span>);
         }
      }
      newAttr = newAttr + attr.substring(i - <span class="hljs-number">1</span>);
      <span class="hljs-keyword">return</span> newAttr;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Validates safely for a nested attribute. If the attr is an array, it will construct
validation errors with the same array structure [‘foo[0]’, ‘foo[1]’] -&gt; [false, ‘Error Example’]
Also handles nested array structure</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> validateWithOpenArrayHelper = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model, attrConfig, value, computed, validators, depth</span>) </span>{
      <span class="hljs-keyword">var</span> attr, indices;

      <span class="hljs-keyword">if</span> (_.isArray(attrConfig)) {
        <span class="hljs-keyword">return</span> _.reduce(attrConfig, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">memo, nestedAttrConfig</span>) </span>{
          memo.push(validateWithOpenArrayHelper(model, nestedAttrConfig, value, computed, validators, depth + <span class="hljs-number">1</span>));
          <span class="hljs-keyword">return</span> memo;
        }, []);
      } <span class="hljs-keyword">else</span> {
        indices = attrConfig.index;
        attr = attrConfig.attr;</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>if the value wasn’t passed in and the attribute is nested, get the value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (_.isUndefined(value) &amp;&amp; isNestedAttr(attr)) {
          value = model.get(attr);
        }
        <span class="hljs-keyword">return</span> invokeValidator(validators, model, value, attr, computed, indices);
      }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Invokes the validator set for an attr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> invokeValidator = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">validators, model, value, attr, computed, indices</span>) </span>{
      <span class="hljs-keyword">return</span> _.reduce(validators, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">memo, validator</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Pass the format functions plus the default
validators as the context to the validator</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">var</span> context = _.extend({<span class="hljs-attr">msgKey</span>: validator.msgKey}, formatFunctions, defaultValidators),
              result = validator.fn.call(context, value, attr, validator.val, model, computed, indices);

          <span class="hljs-keyword">if</span> (result === <span class="hljs-literal">false</span> || memo === <span class="hljs-literal">false</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
          }
          <span class="hljs-keyword">if</span> (result &amp;&amp; !memo) {
            <span class="hljs-keyword">return</span> _.result(_.extend({}, validator, formatFunctions, defaultValidators), <span class="hljs-string">'msg'</span>) || result;
          }
          <span class="hljs-keyword">return</span> memo;
        }, <span class="hljs-string">''</span>);
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Validates an attribute against all validators defined
for that attribute. If one or more errors are found,
the first error message is returned.
If the attribute is valid, an empty string is returned.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> validateAttrWithOpenArray = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model, attr, value, computed</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Reduces the array of validators to an error message by
applying all the validators and returning the first error
message, if any.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> hasErrors, subAttr, result,
        validators = getValidators(model, attr);
      subAttr = generateSubAttributes(attr, model);
      result = validateWithOpenArrayHelper(model, subAttr, value, computed, validators, <span class="hljs-number">0</span>);
      <span class="hljs-keyword">if</span> (_.isArray(result)) {
        hasErrors = _.reduce(_.flatten(result), <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">memo, val</span>) </span>{
          <span class="hljs-keyword">return</span> memo || val;
        }, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">if</span> (!hasErrors) {
          <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        }
      }
      <span class="hljs-keyword">return</span> result;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Loops through the model’s attributes and validates the specified attrs.
Returns and object containing names of invalid attributes
as well as error messages.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> validateModel = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model, attrs, validatedAttrs</span>) </span>{
      <span class="hljs-keyword">var</span> error,
          invalidAttrs = {},
          isValid = <span class="hljs-literal">true</span>,
          computed = _.clone(attrs);

      _.each(validatedAttrs, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">val, attr</span>) </span>{
        error = validateAttrWithOpenArray(model, attr, val, computed);
        <span class="hljs-keyword">if</span> (error) {
          invalidAttrs[attr] = error;
          isValid = <span class="hljs-literal">false</span>;
        }
      });

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">invalidAttrs</span>: invalidAttrs,
        <span class="hljs-attr">isValid</span>: isValid
      };
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Validates attribute without open array notation.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> validateAttr = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">model, value, attr</span>) </span>{
      <span class="hljs-keyword">var</span> indices, validators,
        validations = model.validation ? _.result(model, <span class="hljs-string">'validation'</span>) || {} : {};</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>If the validations hash contains an entry for the attr</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (_.contains(_.keys(validations), attr)) {
        <span class="hljs-keyword">return</span> validateAttrWithOpenArray(model, attr, value, _.extend({}, model.attributes));
      } <span class="hljs-keyword">else</span> {
        indices = extractIndices(attr);
        attr = stripIndices(attr);
        validators = getValidators(model, attr);
        <span class="hljs-keyword">return</span> invokeValidator(validators, model, value, attr, _.extend({}, model.attributes), indices);
      }
    };

    <span class="hljs-comment">/**
     * Contains the methods that are mixed in on the model when binding
     *
     * @mixin validationMixin
     */</span>
    <span class="hljs-keyword">var</span> mixin = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-comment">/** @lends validationMixin */</span> {

        <span class="hljs-comment">/**
         * Check whether an attribute or a set of attributes are valid. It will default to use the model's current values but
         * you can pass in different values to use in the validation process instead.
         * @param {(string|Object|string[])} attr Either the name of the attribute, an array containing many attribute names, or
         * on object with attribute name to values
         * @param {Any} [value] a value to use for the attribute value instead of using the model's value.
         * @returns {(undefined|string|Object)} undefined if no errors, a validation exception if a single attribute, or an object with attribute name as key
         * and the error as the value
         */</span>
        preValidate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr, value</span>) </span>{
          <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>,
              result = {},
              error;
          <span class="hljs-keyword">if</span> (_.isArray(attr)) {
            _.each(attr, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attr</span>) </span>{
              error = self.preValidate(attr);
              <span class="hljs-keyword">if</span> (error) {
                result[attr] = error;
              }
            });
            <span class="hljs-keyword">return</span> _.isEmpty(result) ? <span class="hljs-literal">undefined</span> : result;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_.isObject(attr)) {
            _.each(attr, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, key</span>) </span>{
              error = self.preValidate(key, value);
              <span class="hljs-keyword">if</span> (error) {
                result[key] = error;
              }
            });
            <span class="hljs-keyword">return</span> _.isEmpty(result) ? <span class="hljs-literal">undefined</span> : result;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (_.isUndefined(value) &amp;&amp; isNestedModel(<span class="hljs-keyword">this</span>)) {
              value = <span class="hljs-keyword">this</span>.get(attr);
            }
            <span class="hljs-keyword">return</span> validateAttr(<span class="hljs-keyword">this</span>, value, attr);
          }
        },

        <span class="hljs-comment">/**
         * Check to see if an attribute, an array of attributes or the
         * entire model is valid. Passing true will force a validation
         * of the model.
         */</span>
        isValid: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">option</span>) </span>{
          <span class="hljs-keyword">var</span> flattened, attrs, error, invalidAttrs;

          option = option || getOptionsAttrs(options);

          <span class="hljs-keyword">if</span>(_.isString(option)){
            attrs = [option];
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(_.isArray(option)) {
            attrs = option;
          }
          <span class="hljs-keyword">if</span> (attrs) {</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Loop through all attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.each(attrs, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">attr</span>) </span>{
              <span class="hljs-keyword">var</span> value;
              <span class="hljs-keyword">if</span> (isNestedModel(<span class="hljs-keyword">this</span>)) {
                value = <span class="hljs-keyword">this</span>.get(attr);
              } <span class="hljs-keyword">else</span> {
                value = flatten(<span class="hljs-keyword">this</span>.attributes)[attr];
              }
              error = validateAttr(<span class="hljs-keyword">this</span>, value, attr);
              <span class="hljs-keyword">if</span> (error) {
                invalidAttrs = invalidAttrs || {};
                invalidAttrs[attr] = error;
              }
            }, <span class="hljs-keyword">this</span>);
          }

          <span class="hljs-keyword">if</span> (option === <span class="hljs-literal">true</span>) {
            invalidAttrs = <span class="hljs-keyword">this</span>.validate();
          }
          <span class="hljs-keyword">if</span> (invalidAttrs) {
            <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'invalid'</span>, <span class="hljs-keyword">this</span>, invalidAttrs, {<span class="hljs-attr">validationError</span>: invalidAttrs});
          }
          <span class="hljs-keyword">return</span> attrs ? !invalidAttrs : <span class="hljs-keyword">this</span>.validation ? <span class="hljs-keyword">this</span>._isValid : <span class="hljs-literal">true</span>;
        },

        <span class="hljs-comment">/**
         * This is called by Backbone when it needs to perform validation.
         * You can call it manually without any parameters to validate the
         * entire model.
         */</span>
        validate: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrs, setOptions</span>)</span>{
          <span class="hljs-keyword">var</span> model = <span class="hljs-keyword">this</span>;
          <span class="hljs-keyword">var</span> opt = _.extend({}, options, setOptions);
          <span class="hljs-keyword">var</span> validatedAttrs = getValidatedAttrs(model, getOptionsAttrs(options));
          <span class="hljs-keyword">var</span> allAttrs = _.extend({}, validatedAttrs, model.attributes, attrs);
          <span class="hljs-keyword">var</span> flattened = _.extend(flatten(allAttrs), attrs); <span class="hljs-comment">// allow people to pass in nested attributes</span>
          <span class="hljs-keyword">var</span> changedAttrs = attrs ? flatten(attrs) : flattened;
          <span class="hljs-keyword">var</span> result = validateModel(model, allAttrs, _.pick(flattened, _.keys(validatedAttrs)));
          model._isValid = result.isValid;</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Trigger validated events.
Need to defer this so the model is actually updated before
the event is triggered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          _.defer(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
            model.trigger(<span class="hljs-string">'validated'</span>, model._isValid, model, result.invalidAttrs);
            model.trigger(<span class="hljs-string">'validated:'</span> + (model._isValid ? <span class="hljs-string">'valid'</span> : <span class="hljs-string">'invalid'</span>), model, result.invalidAttrs);
          });</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Return any error messages to Backbone, unless the forceUpdate flag is set.
Then we do not return anything and fools Backbone to believe the validation was
a success. That way Backbone will update the model regardless.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (!opt.forceUpdate &amp;&amp; _.intersection(_.keys(result.invalidAttrs), _.keys(changedAttrs)).length &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> result.invalidAttrs;
          }
        }
      };
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Returns the public methods on Backbone.Validation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-comment">/** @lends Validation */</span> {

      <span class="hljs-comment">/**
       * Current version of the library
       * @type {string}
       */</span>
      version: <span class="hljs-string">'0.11.3'</span>,

      <span class="hljs-comment">/**
       * Called to augment configure the default options
       * @param options
       */</span>
      configure: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">options</span>) </span>{
        _.extend(defaultOptions, options);
      },

      <span class="hljs-comment">/**
       * Used to extend the Backbone.Model.prototype with validation
       *
       * @type {validationMixin}
       */</span>
      mixin: mixin(defaultOptions)
    };
  }());</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <h2 id="patterns">Patterns</h2>

            </div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> defaultPatterns = Validation.patterns = {</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Matches any digit(s) (i.e. 0-9)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    digits: <span class="hljs-regexp">/^\d+$/</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Matches any number (e.g. 100.000)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    number: <span class="hljs-regexp">/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Matches a valid email address (e.g. <a href="mailto:mail@example.com">mail@example.com</a>)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    email: <span class="hljs-regexp">/^((([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&amp;'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Mathes any valid url (e.g. <a href="http://www.xample.com">http://www.xample.com</a>)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    url: <span class="hljs-regexp">/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&amp;'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i</span>
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <h2 id="error-messages">Error messages</h2>

            </div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Error message for the build in validators.
{x} gets swapped out with arguments form the validator.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> defaultMessages = Validation.messages = {
    <span class="hljs-attr">required</span>: <span class="hljs-string">'{0} is required'</span>,
    <span class="hljs-attr">acceptance</span>: <span class="hljs-string">'{0} must be accepted'</span>,
    <span class="hljs-attr">min</span>: <span class="hljs-string">'{0} must be greater than or equal to {1}'</span>,
    <span class="hljs-attr">max</span>: <span class="hljs-string">'{0} must be less than or equal to {1}'</span>,
    <span class="hljs-attr">range</span>: <span class="hljs-string">'{0} must be between {1} and {2}'</span>,
    <span class="hljs-attr">length</span>: <span class="hljs-string">'{0} must be {1} characters'</span>,
    <span class="hljs-attr">minLength</span>: <span class="hljs-string">'{0} must be at least {1} characters'</span>,
    <span class="hljs-attr">maxLength</span>: <span class="hljs-string">'{0} must be at most {1} characters'</span>,
    <span class="hljs-attr">rangeLength</span>: <span class="hljs-string">'{0} must be between {1} and {2} characters'</span>,
    <span class="hljs-attr">oneOf</span>: <span class="hljs-string">'{0} must be one of: {1}'</span>,
    <span class="hljs-attr">equalTo</span>: <span class="hljs-string">'{0} must be the same as {1}'</span>,
    <span class="hljs-attr">digits</span>: <span class="hljs-string">'{0} must only contain digits'</span>,
    <span class="hljs-attr">number</span>: <span class="hljs-string">'{0} must be a number'</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">'{0} must be a valid email'</span>,
    <span class="hljs-attr">url</span>: <span class="hljs-string">'{0} must be a valid url'</span>,
    <span class="hljs-attr">inlinePattern</span>: <span class="hljs-string">'{0} is invalid'</span>
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <h2 id="label-formatters">Label formatters</h2>

            </div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Label formatters are used to convert the attribute name
to a more human friendly label when using the built in
error messages.
Configure which one to use with a call to</p>
<pre><code>Backbone.Validation.configure({
  <span class="hljs-attr">labelFormatter</span>: <span class="hljs-string">'label'</span>
});</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> defaultLabelFormatters = Validation.labelFormatters = {</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Returns the attribute name with applying any formatting</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    none: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrName</span>) </span>{
      <span class="hljs-keyword">return</span> attrName;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Converts attributeName or attribute_name to Attribute name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    sentenceCase: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrName</span>) </span>{
      <span class="hljs-keyword">return</span> attrName.replace(<span class="hljs-regexp">/(?:^\w|[A-Z]|\b\w)/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, index</span>) </span>{
        <span class="hljs-keyword">return</span> index === <span class="hljs-number">0</span> ? match.toUpperCase() : <span class="hljs-string">' '</span> + match.toLowerCase();
      }).replace(<span class="hljs-regexp">/_/g</span>, <span class="hljs-string">' '</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Looks for a label configured on the model and returns it</p>
<pre><code> <span class="hljs-keyword">var</span> Model = Backbone.Model.extend({
   <span class="hljs-attr">validation</span>: {
     <span class="hljs-attr">someAttribute</span>: {
       <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>
     }
   },

   <span class="hljs-attr">labels</span>: {
     <span class="hljs-attr">someAttribute</span>: <span class="hljs-string">'Custom label'</span>
   }
 });</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    label: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">attrName, model</span>) </span>{
      <span class="hljs-keyword">return</span> (model.labels &amp;&amp; model.labels[attrName]) || defaultLabelFormatters.sentenceCase(attrName, model);
    }
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <h2 id="message-formatters">Message Formatters</h2>

            </div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> defaultMessageFormatters = Validation.messageFormatters = {
    <span class="hljs-attr">none</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>),
        text = args.shift();
      <span class="hljs-keyword">return</span> text.replace(<span class="hljs-regexp">/\{(\d+)\}/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, number</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> args[number] !== <span class="hljs-string">'undefined'</span> ? args[number] : match;
      });
    }
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <h2 id="built-in-validators">Built in validators</h2>

            </div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> defaultValidators = Validation.validators = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Use native trim when defined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> trim = <span class="hljs-built_in">String</span>.prototype.trim ?
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">return</span> text === <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : <span class="hljs-built_in">String</span>.prototype.trim.call(text);
      } :
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">text</span>) </span>{
        <span class="hljs-keyword">var</span> trimLeft = <span class="hljs-regexp">/^\s+/</span>,
            trimRight = <span class="hljs-regexp">/\s+$/</span>;

        <span class="hljs-keyword">return</span> text === <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : text.toString().replace(trimLeft, <span class="hljs-string">''</span>).replace(trimRight, <span class="hljs-string">''</span>);
      };</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Determines whether or not a value is a number</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> isNumber = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)</span>{
      <span class="hljs-keyword">return</span> _.isNumber(value) || (_.isString(value) &amp;&amp; value.match(defaultPatterns.number));
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Determines whether or not a value is empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> hasValue = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) </span>{
      <span class="hljs-keyword">return</span> !(_.isNull(value) || _.isUndefined(value) || (_.isString(value) &amp;&amp; trim(value) === <span class="hljs-string">''</span>) || (_.isArray(value) &amp;&amp; _.isEmpty(value)));
    };

    <span class="hljs-keyword">var</span> getMessageKey = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">msgKey, defaultKey</span>) </span>{
      <span class="hljs-keyword">return</span> msgKey ? msgKey : defaultKey;
    };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">format</span>: formatFunctions.format,
      <span class="hljs-attr">formatLabel</span>: formatFunctions.formatLabel,</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Function validator
Lets you implement a custom function used for validation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      fn: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, fn, model, computed</span>) </span>{
        <span class="hljs-keyword">if</span>(_.isString(fn)){
          fn = model[fn];
        }
        <span class="hljs-keyword">return</span> fn.call(model, value, attr, computed);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Allows the creation of an inline function that uses the validators context
instead of the model context.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      inlineFn: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, fn, model, computed, indices</span>) </span>{
        <span class="hljs-keyword">return</span> fn.call(<span class="hljs-keyword">this</span>, value, attr, model, computed, indices);
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Required validator
Validates if the attribute is required or not
This can be specified as either a boolean value or a function that returns a boolean value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      required: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, required, model, computed</span>) </span>{
        <span class="hljs-keyword">var</span> isRequired = _.isFunction(required) ? required.call(model, value, attr, computed) : required;
        <span class="hljs-keyword">if</span>(!isRequired &amp;&amp; !hasValue(value)) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// overrides all other validators</span>
        }
        <span class="hljs-keyword">if</span> (isRequired &amp;&amp; !hasValue(value)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.required), <span class="hljs-keyword">this</span>.formatLabel(attr, model));
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Acceptance validator
Validates that something has to be accepted, e.g. terms of use
<code>true</code> or ‘true’ are valid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      acceptance: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, accept, model</span>) </span>{
        <span class="hljs-keyword">if</span>(value !== <span class="hljs-string">'true'</span> &amp;&amp; (!_.isBoolean(value) || value === <span class="hljs-literal">false</span>)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.acceptance), <span class="hljs-keyword">this</span>.formatLabel(attr, model));
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Min validator
Validates that the value has to be a number and equal to or greater than
the min value specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      min: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, minValue, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!isNumber(value) || value &lt; minValue) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.min), <span class="hljs-keyword">this</span>.formatLabel(attr, model), minValue);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Max validator
Validates that the value has to be a number and equal to or less than
the max value specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      max: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, maxValue, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!isNumber(value) || value &gt; maxValue) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.max), <span class="hljs-keyword">this</span>.formatLabel(attr, model), maxValue);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Range validator
Validates that the value has to be a number and equal to or between
the two numbers specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      range: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, range, model</span>) </span>{
        <span class="hljs-keyword">if</span>(!isNumber(value) || value &lt; range[<span class="hljs-number">0</span>] || value &gt; range[<span class="hljs-number">1</span>]) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.range), <span class="hljs-keyword">this</span>.formatLabel(attr, model), range[<span class="hljs-number">0</span>], range[<span class="hljs-number">1</span>]);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Length validator
Validates that the value has to be a string with length equal to
the length value specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      length: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, length, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length !== length) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.length), <span class="hljs-keyword">this</span>.formatLabel(attr, model), length);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Min length validator
Validates that the value has to be a string with length equal to or greater than
the min length value specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      minLength: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, minLength, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length &lt; minLength) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.minLength), <span class="hljs-keyword">this</span>.formatLabel(attr, model), minLength);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Max length validator
Validates that the value has to be a string with length equal to or less than
the max length value specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      maxLength: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, maxLength, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length &gt; maxLength) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.maxLength), <span class="hljs-keyword">this</span>.formatLabel(attr, model), maxLength);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Range length validator
Validates that the value has to be a string and equal to or between
the two numbers specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      rangeLength: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, range, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!_.isString(value) || value.length &lt; range[<span class="hljs-number">0</span>] || value.length &gt; range[<span class="hljs-number">1</span>]) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.rangeLength), <span class="hljs-keyword">this</span>.formatLabel(attr, model), range[<span class="hljs-number">0</span>], range[<span class="hljs-number">1</span>]);
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>One of validator
Validates that the value has to be equal to one of the elements in
the specified array. Case sensitive matching</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      oneOf: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, values, model</span>) </span>{
        <span class="hljs-keyword">if</span>(!_.include(values, value)){
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.oneOf), <span class="hljs-keyword">this</span>.formatLabel(attr, model), values.join(<span class="hljs-string">', '</span>));
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Equal to validator
Validates that the value has to be equal to the value of the attribute
with the name specified</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      equalTo: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, equalTo, model, computed</span>) </span>{
        <span class="hljs-keyword">if</span>(value !== computed[equalTo]) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages.equalTo), <span class="hljs-keyword">this</span>.formatLabel(attr, model), <span class="hljs-keyword">this</span>.formatLabel(equalTo, model));
        }
      },</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Pattern validator
Validates that the value has to match the pattern specified.
Can be a regular expression or the name of one of the built in patterns</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      pattern: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">value, attr, pattern, model</span>) </span>{
        <span class="hljs-keyword">if</span> (!hasValue(value) || !value.toString().match(defaultPatterns[pattern] || pattern)) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format(getMessageKey(<span class="hljs-keyword">this</span>.msgKey, defaultMessages[pattern]) || defaultMessages.inlinePattern, <span class="hljs-keyword">this</span>.formatLabel(attr, model), pattern);
        }
      }
    };
  }());

  <span class="hljs-keyword">return</span> Validation;
}));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
